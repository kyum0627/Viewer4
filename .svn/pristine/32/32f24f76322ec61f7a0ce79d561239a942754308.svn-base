using IGX.ViewControl.Render;
using OpenTK.GLControl;
using OpenTK.Mathematics;

namespace IGX.ViewControl
{
    public interface ISharedGLResources2 : IDisposable
    {
        int PositionBuffer { get; }
        int ColorBuffer { get; }
        int EBO { get; }
        int VertexCount { get; }
        Vector3[] VertexData { get; } // Added for ray casting
        int[] IndexData { get; } // Added for ray casting
        void Initialize(GLControl context);
    }
    public interface IInitializer
    {
        int Initialize(GLControl control, IRenderPipeline renderPipeline, IVAOSetup2 vertexSetup, ISharedGLResources2 sharedResources, Action setupViewport, Action render);
    }
    public interface IMatrixCalculator
    {
        Matrix4 CalculateMVP(GLControl control, IMyCamera camera, IRenderConfig renderConfig);
        void InvalidateCache();
    }
    public interface IObjectSelector : IDisposable
    {
        void SelectObject(GLControl context, int mouseX, int mouseY, IMyCamera camera, IRenderConfig renderConfig, ISharedGLResources2 sharedResources);
    }
    public interface IRenderConfig
    {
        Color4 BackgroundColor { get; }
        Matrix4 GetModelMatrix(float deltaTime);
        ISet<int> SelectedIndices { get; }
        Color4 HighlightColor { get; }
    }
    public interface IRenderPipeline : IDisposable
    {
        void Initialize(GLControl control);
        void Render(GLControl control, int vao, Matrix4 mvp, IVAOSetup2 vertexSetup, IRenderConfig renderConfig);
    }
    public interface IShaderManager : IDisposable
    {
        void Initialize(GLControl control);
        void UseDefaultShader();
        void UseHighlightShader();
        void SetUniforms(Matrix4 mvp);
    }
    // Interface for shader program management
    public interface IShaderProgram : IDisposable
    {
        string VertexShaderSource { get; }
        string FragmentShaderSource { get; }
        void Initialize(GLControl context);
        void Use();
        void SetUniforms(Matrix4 mvp);
        int GetProgramId();
    }
    // Interface for vertex array object setup and rendering action
    public interface IVAOSetup2
    {
        int SetupVAO(GLControl context, ISharedGLResources2 sharedResources);
        Action<GLControl, int> GetRenderAction();
        Action<GLControl, int, ISet<int>> GetHighlightRenderAction();
    }
    public interface IViewportManager
    {
        void SetupViewport(GLControl control);
        Size GetViewportSize(GLControl control);
    }
}
